<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="roleR">
<title>roleR Use Cases • roleR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="roleR Use Cases">
<meta property="og:description" content="roleR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">roleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/roleR_intro.html">roleR_intro</a>
    <a class="dropdown-item" href="../articles/roleR_use_cases.html">roleR Use Cases</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>roleR Use Cases</h1>
                        <h4 data-toc-skip class="author">Jacob Idec</h4>
            
            <h4 data-toc-skip class="date">2022-10-16</h4>
      
      
      <div class="d-none name"><code>roleR_use_cases.Rmd</code></div>
    </div>

    
    
<p>This document shows off various use cases using the current
implementation of roleR</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#devtools::install_github("role-model/roleR",dependencies=TRUE)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">roleR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roleParams.html">roleParams</a></span><span class="op">(</span>individuals_local <span class="op">=</span> <span class="fl">100</span>, individuals_meta <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                         species_meta <span class="op">=</span> <span class="fl">50</span>, speciation_local <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                         speciation_meta <span class="op">=</span> <span class="fl">0.05</span>, extinction_meta <span class="op">=</span> <span class="fl">0.05</span>, env_sigma <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                         trait_sigma<span class="op">=</span><span class="fl">1</span>,comp_sigma <span class="op">=</span> <span class="fl">0.5</span>, dispersal_prob <span class="op">=</span> <span class="fl">0.1</span>, mutation_rate <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                         equilib_escape <span class="op">=</span> <span class="fl">1</span>, num_basepairs <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         init_type <span class="op">=</span> <span class="st">'oceanic_island'</span>, niter <span class="op">=</span> <span class="fl">1000</span>, niterTimestep <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runRoLE.html">runRoLE</a></span><span class="op">(</span><span class="fu"><a href="../reference/roleModel.html">roleModel</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSumStats.html">getSumStats</a></span><span class="op">(</span><span class="va">model</span>,funs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rich<span class="op">=</span><span class="va">richness</span><span class="op">)</span><span class="op">)</span> <span class="co">#TODO add default where all existing sumstats are added</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">stats</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">iteration</span>, <span class="va">rich</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="roleR_use_cases_files/figure-html/overview-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="parameter-creation">Parameter Creation<a class="anchor" aria-label="anchor" href="#parameter-creation"></a>
</h2>
<p>Create a set of parameters specifying every one</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roleParams.html">roleParams</a></span><span class="op">(</span>individuals_local <span class="op">=</span> <span class="fl">100</span>, individuals_meta <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                         species_meta <span class="op">=</span> <span class="fl">50</span>, speciation_local <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                         speciation_meta <span class="op">=</span> <span class="fl">0.05</span>, extinction_meta <span class="op">=</span> <span class="fl">0.05</span>, env_sigma <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                         trait_sigma<span class="op">=</span><span class="fl">1</span>,comp_sigma <span class="op">=</span> <span class="fl">0.5</span>, dispersal_prob <span class="op">=</span> <span class="fl">0.1</span>, mutation_rate <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                         equilib_escape <span class="op">=</span> <span class="fl">1</span>, num_basepairs <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         init_type <span class="op">=</span> <span class="st">'oceanic_island'</span>, niter <span class="op">=</span> <span class="fl">1000</span>, niterTimestep <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Create a set of params per the Unified Neutral Theory of Biodiversity
(UNTB). This creates a “UNTB-flavored” RoLE model</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_untb</span> <span class="op">&lt;-</span> <span class="fu">untbParams</span><span class="op">(</span>individuals_local <span class="op">=</span> <span class="fl">100</span>, individuals_meta <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                        species_meta <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                        speciation <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>                        dispersal_prob <span class="op">=</span> <span class="fl">0.1</span>, init_type <span class="op">=</span> <span class="st">'oceanic_island'</span>,</span>
<span>                        niter <span class="op">=</span> <span class="fl">30000</span>, niterTimestep <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>   </span></code></pre></div>
<p>See the roleParams documentation for descriptions of all available
parameters</p>
<p><span style="color:blue">Group Question: Should default parameters
exist so that simply p &lt;- roleParams() creates a valid params? If so
what should the defaults be? </span></p>
</div>
<div class="section level2">
<h2 id="model-experiment-creation-running">Model &amp; Experiment Creation &amp; Running<a class="anchor" aria-label="anchor" href="#model-experiment-creation-running"></a>
</h2>
<p>Create a model (not yet run) using the params, then run it</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roleModel.html">roleModel</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runRoLE.html">runRoLE</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>Create an experiment (not yet run) containing two models created
using both sets of params, then run it. Experiment running can be
parallelized on Windows, Mac, &amp; Linux by specifying the number of
cores to use. When you run an experiment, it runs every model within
it.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roleExperiment.html">roleExperiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">p_untb</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#library(parallel)</span></span>
<span><span class="co">#exp &lt;- runRoLE(exp,cores=2)</span></span></code></pre></div>
<p>Experiments are intended to encapsulate one or more hypotheses
through comparison of multiple varying models contained within them</p>
<p><span style="color:blue">Group Question: Is encapsulating multiple
models as experiments useful, or would you rather deal with models
individually in your use cases? </span></p>
</div>
<div class="section level2">
<h2 id="extracting-data-from-models">Extracting Data From Models<a class="anchor" aria-label="anchor" href="#extracting-data-from-models"></a>
</h2>
<p>Get a summary stats over time for a single model, each row being a
different saved iteration state. Available raw stats are rawAbundance,
rawSpAbundance, rawTraits, rawGenDiv, rawBranchLengths, and rawApePhylo.
Available transformed stats are hillAbund, hillGenetic, hillTrait,
hillPhylo, and richness.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSumStats.html">getSumStats</a></span><span class="op">(</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rich <span class="op">=</span> <span class="va">richness</span>,hill_abund<span class="op">=</span><span class="va">hillAbund</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stats</span></span></code></pre></div>
<pre><code><span><span class="co">##    rich hill_abund_1 hill_abund_2 hill_abund_3 hill_abund_4 iteration</span></span>
<span><span class="co">## 1     1     1.000000     1.000000     1.000000     1.000000         0</span></span>
<span><span class="co">## 2    15     2.878159     1.628664     1.451319     1.392741       100</span></span>
<span><span class="co">## 3    20     4.513310     2.124947     1.782460     1.672288       200</span></span>
<span><span class="co">## 4    13     3.411287     1.893222     1.635853     1.549570       300</span></span>
<span><span class="co">## 5    20     6.211256     2.927400     2.318071     2.115546       400</span></span>
<span><span class="co">## 6    24     8.899449     4.108463     3.081785     2.734310       500</span></span>
<span><span class="co">## 7    21     7.943058     3.903201     2.980974     2.657831       600</span></span>
<span><span class="co">## 8    19     6.998104     3.706449     2.887642     2.585832       700</span></span>
<span><span class="co">## 9    19     7.889036     3.937008     2.988072     2.659203       800</span></span>
<span><span class="co">## 10   22    10.972850     5.611672     4.056069     3.504531       900</span></span>
<span><span class="co">## 11   20    10.883219     6.337136     4.693853     4.035401      1000</span></span></code></pre>
<!-- Get summary stats over time for one model of an experiment -->
<!-- ```{r series2, cache = TRUE} -->
<!-- stats <- getSumStats(exp@modelRuns[[1]], list(hill_abund=hillAbund)) -->
<!-- ``` -->
<!-- Create a custom summary statistic and extract it -->
<!-- ```{r series3, cache = TRUE} -->
<!-- speciesWith5Indv <- function(x){return(sum(x@localComm@spAbund > 4))} -->
<!-- stats <- getSumStats(exp@modelRuns[[1]], list(sp_with_5=speciesWith5Indv)) -->
<!-- ``` -->
<!-- <span style="color:blue">Group Question: Any ideas for more default summary stats we could add? </span> -->
<!-- <span style="color:blue">Group Question: Besides plotting model data over model iterations, any plotting functions you would want? </span> -->
<!-- ## Extracting Data From Experiments -->
<!-- Get a dataframe containing all saved timesteps of all models in the experiment -->
<!-- ```{r data, cache = TRUE} -->
<!-- stats <- getSumStats(exp, list(hill_abund=hillAbund)) -->
<!-- ``` -->
<!-- Get a dataframe containing model metadata in the experiment, where each row is an experiment with its associated params -->
<!-- ```{r data2, cache = TRUE} -->
<!-- exp_model_params <- exp@experimentMeta -->
<!-- ``` -->
<!-- Get transformed summary stats (such as the mean of a stat at an iteration for multiple models) from an experiment (WIP) -->
<!-- ```{r series4, cache = TRUE} -->
<!-- # stats <- getSumStats(exp, list(hill_abund_itermean=hillAbundItermean)) -->
<!-- ## where hillAbundItermean is a function that applies across an experiment rather than across a roleData -->
<!-- ``` -->
<!-- <span style="color:blue">Group Question: Are transformed summary stats summarized from multiple models useful? Any other multiple-model-summarizing functions other than mean? Also let us know if this concept is unclear, it is a little confusing. </span> -->
<!-- ## Parameter Priors & Iter-Functions (WIP) -->
<!-- Functions can be set that sample params at every iteration step -->
<!-- A prior is any function that takes no inputs and returns a parameter value -->
<!-- Change one parameter to be sampled from a normal distribution every iteration -->
<!-- ```{r priors, cache = TRUE} -->
<!-- # p@speciation_local <- function(){return(rnorm(1,mean=0.05,sd=0.01))} -->
<!-- ``` -->
<!-- An iter-function takes an iteration number and returns a parameter value -->
<!-- Change one parameter to increase linearly every iteration -->
<!-- ```{r iterfuns, cache = TRUE} -->
<!-- #p@speciation_local <- function(iter){return(iter * 0.001)} -->
<!-- plot(1:1000 * 0.001,xlab = "iteration",ylab = "speciation rate") -->
<!-- ``` -->
<!-- Create a simple piecewise function where a param changes during some iterations -->
<!-- ```{r iterfuns2, cache = TRUE} -->
<!-- #p@env_sigma <- function(iter){ -->
<!-- #        if(iter > 400 & iter < 600){ -->
<!-- #            return(0.75) -->
<!-- #        } -->
<!-- #        else{ -->
<!-- #            return(0.5) -->
<!-- #        } -->
<!-- #    } -->
<!-- ``` -->
<!-- <span style="color:blue">Group Question: What are some ways in which you would want to vary parameters? Do priors and iterfuncs capture the kind of parameter variability you would want? </span> -->
<!-- <span style="color:blue">Group Question: We are considering two ways of handling priors and iterfuns. The first is allow the parameter slot to include either a vector or a function as in the example. The second is have an additional class called roleFunctions that would overwrite params it contains, for the purpose of avoiding confusion that could be caused by a multiple-class slot. Let us know if you have any feelings about these! </span> -->
<!-- ## Simulating Genetic Diversities (WIP) -->
<!-- Add genetic diversities to a run model by backwards time simulation using msprime -->
<!-- ```{r gendiv, cache = TRUE} -->
<!-- #model <- simulateSpeciesGenDiv(model) -->
<!-- ``` -->
<!-- ## Experiment Organization -->
<!-- Tag models in an experiment for comparison between different tags -->
<!-- ```{r adv, cache = TRUE} -->
<!-- names(exp@modelRuns) <- c("basic","neut") -->
<!-- ``` -->
<!-- Set metadata of experiment within the object, which is exported when saving -->
<!-- ```{r adv2, cache = TRUE} -->
<!-- exp <- setExpMetadata(exp, author="Jacob Idec", date="10/18/22", description="A test experiment") -->
<!-- ``` -->
<!-- <span style="color:blue">Group Question: Is this basic metadata sufficient? Should the description be split up into more specific parts? </span> -->
<!-- ## Writing and Loading -->
<!-- Write and load models, experiments, and params -->
<!-- ```{r saving, cache = TRUE} -->
<!-- writeRoLE(exp,dir="",filename="test",save_txt = T) -->
<!-- exp <- readRDS("test.roleexperiment") -->
<!-- ``` -->
<!-- ## Predictive Models (WIP) -->
<!-- Use a run experiment to make a model predicting a parameter from summary stats -->
<!-- ```{r preds, cache = TRUE} -->
<!-- #pred_model <- createPredModel(exp,param_name = "speciation_local", preds=c("hill_abund1","hill_abund2")) -->
<!-- ``` -->
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andrew Rominger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
